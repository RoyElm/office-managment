"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{6261:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var l=a(5155),s=a(2115);function r(e){let{onMapUpload:t,existingMapImage:a}=e,[r,o]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{a&&i(a)},[a]);let d=e=>{if(!e.type.match("image/jpeg")&&!e.type.match("image/png"))return void alert("Please upload a JPG or PNG image file.");let a=new FileReader;a.onload=e=>{var t;(null==(t=e.target)?void 0:t.result)&&i(e.target.result)},a.readAsDataURL(e),t(e)},m=()=>{c.current&&(c.current.value="",c.current.click())};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Map Upload"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:"Upload an office map image (JPG, PNG)."}),n?(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("img",{src:n,alt:"Office Map Preview",className:"max-w-full h-auto rounded-lg shadow-sm"}),(0,l.jsxs)("div",{className:"absolute top-2 right-2 flex space-x-2",children:[(0,l.jsx)("button",{className:"bg-blue-500 text-white p-2 rounded-full",onClick:m,title:"Replace with new image",type:"button",children:(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,l.jsx)("path",{d:"M5.5 13a3.5 3.5 0 01-.369-6.98 4 4 0 117.753-1.977A4.5 4.5 0 1113.5 13H11V9.413l1.293 1.293a1 1 0 001.414-1.414l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13H5.5z"}),(0,l.jsx)("path",{d:"M9 13h2v5a1 1 0 11-2 0v-5z"})]})}),(0,l.jsx)("button",{className:"bg-red-500 text-white p-2 rounded-full",onClick:()=>{i(null)},title:"Remove current image",type:"button",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]}),(0,l.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Map uploaded successfully. You can now place employees on the map."}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Need to replace the image? Click the upload button in the top-right corner of the image."})]}):(0,l.jsxs)("div",{className:"border-2 border-dashed ".concat(r?"border-blue-500 bg-blue-50":"border-gray-300"," rounded-lg p-12 text-center transition-colors"),onDragOver:e=>{e.preventDefault(),o(!0)},onDragLeave:()=>{o(!1)},onDrop:e=>{e.preventDefault(),o(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&d(e.dataTransfer.files[0])},children:[(0,l.jsx)("p",{className:"text-gray-500 mb-2",children:"Drag and drop your map image here"}),(0,l.jsx)("p",{className:"text-gray-400 text-sm",children:"or"}),(0,l.jsx)("button",{className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",onClick:m,type:"button",children:"Browse Files"}),(0,l.jsx)("input",{type:"file",ref:c,className:"hidden",accept:".jpg,.jpeg,.png",onChange:e=>{e.target.files&&e.target.files[0]&&d(e.target.files[0])}})]})]})}function o(e){let{onEmployeesImport:t}=e,[a,r]=(0,s.useState)(!1),[o,n]=(0,s.useState)(null),i=(0,s.useRef)(null),c=e=>{if(n(null),!e.name.endsWith(".csv"))return void n("Please upload a CSV file.");let a=new FileReader;a.onload=e=>{try{var a;if(null==(a=e.target)?void 0:a.result){let a=e.target.result,l=d(a);if(0===l.length)return void n("No valid employees found in the CSV. Please check the format.");t(l)}}catch(e){n('Failed to parse CSV. Please ensure it has "first name" and "last name" columns.')}},a.onerror=()=>{n("Failed to read the file. Please try again.")},a.readAsText(e)},d=e=>{let t=e.split(/\r?\n/).filter(e=>e.trim().length>0);if(t.length<2)throw Error("CSV must have at least a header row and one data row");let a=t[0].split(",").map(e=>e.trim().toLowerCase()),l=a.findIndex(e=>"first name"===e||"firstname"===e),s=a.findIndex(e=>"last name"===e||"lastname"===e);if(-1===l||-1===s)throw Error('CSV must have "first name" and "last name" columns');let r=[];for(let e=1;e<t.length;e++){let a=t[e].split(",").map(e=>e.trim());a.length>Math.max(l,s)&&r.push({firstName:a[l],lastName:a[s]})}return r};return(0,l.jsxs)("div",{className:"w-full mb-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Import Employees from CSV"}),(0,l.jsx)("p",{className:"text-gray-600 mb-4",children:'Upload a CSV file with "first name" and "last name" columns to import employees.'}),(0,l.jsxs)("div",{className:"border-2 border-dashed ".concat(a?"border-blue-500 bg-blue-50":"border-gray-300"," rounded-lg p-8 text-center transition-colors"),onDragOver:e=>{e.preventDefault(),r(!0)},onDragLeave:()=>{r(!1)},onDrop:e=>{e.preventDefault(),r(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&c(e.dataTransfer.files[0])},children:[(0,l.jsx)("p",{className:"text-gray-500 mb-2",children:"Drag and drop your CSV file here"}),(0,l.jsx)("p",{className:"text-gray-400 text-sm",children:"or"}),(0,l.jsx)("button",{className:"mt-2 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",onClick:()=>{var e;null==(e=i.current)||e.click()},children:"Browse Files"}),(0,l.jsx)("input",{type:"file",ref:i,className:"hidden",accept:".csv",onChange:e=>{e.target.files&&e.target.files[0]&&c(e.target.files[0])}})]}),o&&(0,l.jsx)("div",{className:"mt-4 p-3 bg-red-100 text-red-700 rounded-md",children:o}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"CSV Format Example:"}),(0,l.jsx)("div",{className:"bg-gray-100 p-3 rounded-md font-mono text-sm overflow-x-auto",children:(0,l.jsxs)("pre",{children:["first name,last name",(0,l.jsx)("br",{}),"John,Doe",(0,l.jsx)("br",{}),"Jane,Smith"]})})]})]})}function n(e){var t,a,r;let{mapImage:n,employees:i,onEmployeeAdd:c,onEmployeeUpdate:d,onEmployeeRemove:m,onEmployeesBulkAdd:p}=e,[u,h]=(0,s.useState)(!1),[x,g]=(0,s.useState)(null),[f,b]=(0,s.useState)(!1),[y,j]=(0,s.useState)(null),[v,N]=(0,s.useState)(null),[w,C]=(0,s.useState)([]),S=(0,s.useRef)(null);(0,s.useEffect)(()=>{C(i.filter(e=>e.position.x<.1&&e.position.y<.1||0===e.position.x&&0===e.position.y))},[i]);let k=(e,t)=>{t.stopPropagation(),g(e)},M=(e,t)=>{d(e,{name:t})},E=(e,t)=>{d(e,{team:t})},R=e=>{m(e),g(null)},T=(e,t)=>{t.stopPropagation(),j(e),g(e)},D=e=>{N(e),h(!1)};return(0,s.useEffect)(()=>{if(y){let e=()=>j(null);return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}}},[y]),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"flex flex-wrap justify-between items-center mb-4 gap-2",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Employee Placement"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{className:"px-4 py-2 rounded-md ".concat(u?"bg-green-500":"bg-blue-500"," text-white"),onClick:()=>{h(!u),N(null)},children:u?"Cancel":"Add Employee"}),(0,l.jsx)("button",{className:"px-4 py-2 rounded-md bg-purple-500 text-white",onClick:()=>b(!f),children:f?"Cancel Import":"Import from CSV"})]})]}),f&&(0,l.jsxs)("div",{className:"mb-6 p-5 border rounded-lg bg-gray-50",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"font-medium text-lg",children:"Import Employees from CSV"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Upload a CSV file with employee names to add them to the map. Employees will need to be placed manually after import."})]}),(0,l.jsx)(o,{onEmployeesImport:e=>{p(e.map((e,t)=>({id:"emp-csv-".concat(Date.now(),"-").concat(t),name:"".concat(e.firstName," ").concat(e.lastName),position:{x:0,y:0}}))),b(!1)}}),(0,l.jsxs)("div",{className:"mt-4 bg-blue-50 p-3 rounded-md border border-blue-200",children:[(0,l.jsx)("h4",{className:"font-medium text-blue-700",children:"What happens after import?"}),(0,l.jsxs)("ul",{className:"list-disc list-inside mt-2 text-sm text-blue-700",children:[(0,l.jsx)("li",{children:'Imported employees will appear in the "Unlocated Employees" list'}),(0,l.jsx)("li",{children:"Click on an employee name and then click on the map to place them"}),(0,l.jsx)("li",{children:'Each employee\'s name will be set to "First Last" from the CSV'}),(0,l.jsx)("li",{children:"Teams can be assigned after placement"})]})]})]}),w.length>0&&!f&&(0,l.jsxs)("div",{className:"mb-6 p-4 border rounded-lg bg-yellow-50",children:[(0,l.jsxs)("h3",{className:"font-medium mb-2 text-yellow-800",children:["Unlocated Employees (",w.length,")"]}),(0,l.jsx)("p",{className:"text-sm text-yellow-700 mb-3",children:v?"Click on the map to place the selected employee":"Click on an employee's name below, then click on the map to place them"}),(0,l.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map(e=>(0,l.jsx)("button",{className:"px-3 py-1 text-sm rounded-full ".concat(v===e.id?"bg-green-500 text-white":"bg-white border border-yellow-300 hover:bg-yellow-100"),onClick:()=>D(e.id),children:e.name},e.id))})]}),(u||v)&&!f&&(0,l.jsx)("div",{className:"mb-4 p-2 bg-yellow-100 rounded-md",children:(0,l.jsx)("p",{className:"text-sm text-yellow-800",children:v?'Click on the map to place "'.concat((null==(t=i.find(e=>e.id===v))?void 0:t.name)||"employee",'"'):"Click on the map to place a new employee"})}),!f&&(0,l.jsxs)("div",{className:"relative border rounded-lg overflow-hidden",ref:S,onClick:e=>{if(!u&&!v||!S.current)return;let t=S.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,l=(e.clientY-t.top)/t.height*100;if(v)i.find(e=>e.id===v)&&(d(v,{position:{x:a,y:l}}),N(null),g(v));else{let e={id:"emp-".concat(Date.now()),name:"New Employee",position:{x:a,y:l}};c(e),h(!1),g(e.id)}},onMouseMove:e=>{if(!y||!S.current)return;let t=S.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100;d(y,{position:{x:Math.max(0,Math.min(100,a)),y:Math.max(0,Math.min(100,(e.clientY-t.top)/t.height*100))}})},onMouseUp:()=>{j(null)},children:[(0,l.jsx)("img",{src:n,alt:"Office Map",className:"w-full h-auto"}),i.filter(e=>e.position.x>.1||e.position.y>.1).map(e=>(0,l.jsx)("div",{className:"absolute w-8 h-8 transform -translate-x-1/2 -translate-y-1/2 rounded-full flex items-center justify-center cursor-move ".concat(x===e.id?"ring-2 ring-blue-500 bg-blue-100":e.team?function(e){let t=e.split("").reduce((e,t)=>t.charCodeAt(0)+e,0),a=["bg-blue-400","bg-green-400","bg-purple-400","bg-yellow-400","bg-red-400","bg-indigo-400","bg-pink-400","bg-cyan-400","bg-emerald-400","bg-orange-400","bg-teal-400","bg-fuchsia-400"];return a[t%a.length]}(e.team):"bg-gray-400"," ").concat(y===e.id?"opacity-70":""),style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},onClick:t=>k(e.id,t),onMouseDown:t=>T(e.id,t),children:e.name.substring(0,2).toUpperCase()},e.id))]}),x&&!f&&(0,l.jsxs)("div",{className:"mt-4 p-4 border rounded-lg",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Employee Details"}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md",value:(null==(a=i.find(e=>e.id===x))?void 0:a.name)||"",onChange:e=>M(x,e.target.value)})]}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Team"}),(0,l.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md",value:(null==(r=i.find(e=>e.id===x))?void 0:r.team)||"",onChange:e=>E(x,e.target.value)})]}),(0,l.jsx)("button",{className:"px-3 py-1 bg-red-500 text-white rounded-md text-sm",onClick:()=>R(x),children:"Remove Employee"})]})]})}function i(e){var t;let{mapImage:a,rooms:r,onRoomAdd:o,onRoomUpdate:n,onRoomRemove:i}=e,[c,d]=(0,s.useState)(!1),[m,p]=(0,s.useState)(null),u=(0,s.useRef)(null),h=(e,t)=>{t.stopPropagation(),p(e)},x=(e,t)=>{n(e,{name:t})},g=e=>{i(e),p(null)};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Room Renaming"}),(0,l.jsx)("button",{className:"px-4 py-2 rounded-md ".concat(c?"bg-green-500":"bg-blue-500"," text-white"),onClick:()=>d(!c),children:c?"Cancel":"Add Room Label"})]}),c&&(0,l.jsx)("div",{className:"mb-4 p-2 bg-yellow-100 rounded-md",children:(0,l.jsx)("p",{className:"text-sm text-yellow-800",children:"Click on the map to place a room label"})}),(0,l.jsxs)("div",{className:"relative border rounded-lg overflow-hidden",ref:u,onClick:e=>{if(!c||!u.current)return;let t=u.current.getBoundingClientRect(),a=(e.clientX-t.left)/t.width*100,l=(e.clientY-t.top)/t.height*100,s={id:"room-".concat(Date.now()),name:"New Room",position:{x:a,y:l}};o(s),d(!1),p(s.id)},children:[(0,l.jsx)("img",{src:a,alt:"Office Map",className:"w-full h-auto"}),r.map(e=>(0,l.jsx)("div",{className:"absolute px-2 py-1 transform -translate-x-1/2 -translate-y-1/2 cursor-pointer ".concat(m===e.id?"bg-blue-100 border-2 border-blue-500":"bg-white/80 border border-gray-300"),style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},onClick:t=>h(e.id,t),children:e.name},e.id))]}),m&&(0,l.jsxs)("div",{className:"mt-4 p-4 border rounded-lg",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Room Details"}),(0,l.jsxs)("div",{className:"mb-3",children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,l.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md",value:(null==(t=r.find(e=>e.id===m))?void 0:t.name)||"",onChange:e=>x(m,e.target.value)})]}),(0,l.jsx)("button",{className:"px-3 py-1 bg-red-500 text-white rounded-md text-sm",onClick:()=>g(m),children:"Remove Room Label"})]})]})}var c=a(1857);function d(e){let{employee:t,baseUrl:a}=e,[r,o]=(0,s.useState)(!1),n=(()=>{let e=a.endsWith("/")?a.slice(0,-1):a;return"".concat(e,"?highlight=").concat(t.id)})();return(0,l.jsxs)("div",{className:"relative inline-block",children:[(0,l.jsx)("button",{className:"px-3 py-1 bg-purple-500 text-white rounded-md text-sm hover:bg-purple-600 transition-colors",onClick:()=>o(!r),children:r?"Hide QR":"Show QR"}),r&&(0,l.jsx)("div",{className:"absolute z-50 top-full left-1/2 transform -translate-x-1/2 mt-2 p-4 bg-white rounded-lg shadow-xl border",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsxs)("h3",{className:"text-lg font-semibold mb-2",children:[t.name,"'s Location"]}),(0,l.jsx)("div",{className:"bg-white p-2 rounded-lg",children:(0,l.jsx)(c.h,{value:n,size:200,bgColor:"#ffffff",fgColor:"#000000",level:"L",includeMargin:!1})}),(0,l.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"Scan to view location"}),(0,l.jsxs)("div",{className:"mt-2 flex gap-2",children:[(0,l.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded-md text-xs",onClick:()=>{navigator.clipboard.writeText(n),alert("URL copied to clipboard!")},children:"Copy Link"}),(0,l.jsx)("button",{className:"px-3 py-1 bg-gray-500 text-white rounded-md text-xs",onClick:()=>o(!1),children:"Close"})]})]})})]})}var m=a(9137),p=a.n(m);function u(e){let{employees:t,baseUrl:a,onClose:r}=e,o=e=>{let t=a.endsWith("/")?a.slice(0,-1):a;return"".concat(t,"?highlight=").concat(e)};return(0,s.useEffect)(()=>{let e=setTimeout(()=>{window.print()},500);return()=>clearTimeout(e)},[]),(0,l.jsxs)("div",{className:"jsx-24cfeb88d86a3096 p-6",children:[(0,l.jsxs)("div",{className:"jsx-24cfeb88d86a3096 flex justify-between items-center mb-8 print:hidden",children:[(0,l.jsx)("h1",{className:"jsx-24cfeb88d86a3096 text-2xl font-bold",children:"Employee QR Codes"}),(0,l.jsxs)("div",{className:"jsx-24cfeb88d86a3096 flex gap-4",children:[(0,l.jsx)("button",{onClick:()=>window.print(),className:"jsx-24cfeb88d86a3096 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Print"}),(0,l.jsx)("button",{onClick:r,className:"jsx-24cfeb88d86a3096 px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Close"})]})]}),(0,l.jsx)("div",{className:"jsx-24cfeb88d86a3096 grid grid-cols-1 md:grid-cols-2 gap-8",children:t.map(e=>(0,l.jsxs)("div",{className:"jsx-24cfeb88d86a3096 p-6 border rounded-lg flex flex-col items-center page-break-inside-avoid",children:[(0,l.jsx)("h2",{className:"jsx-24cfeb88d86a3096 text-2xl font-bold mb-2",children:e.name}),e.team&&(0,l.jsxs)("div",{className:"jsx-24cfeb88d86a3096 text-gray-600 mb-4",children:["Team: ",e.team]}),(0,l.jsx)("div",{className:"jsx-24cfeb88d86a3096 h-1 w-full bg-gray-300 my-4"}),(0,l.jsx)("div",{className:"jsx-24cfeb88d86a3096 bg-white p-4 rounded-lg",children:(0,l.jsx)(c.h,{value:o(e.id),size:200,bgColor:"#ffffff",fgColor:"#000000",level:"L",includeMargin:!1})}),(0,l.jsx)("p",{className:"jsx-24cfeb88d86a3096 mt-4 text-sm text-gray-500",children:"Scan to view location on office map"})]},e.id))}),(0,l.jsx)(p(),{id:"24cfeb88d86a3096",children:"@media print{@page{size:auto;margin:15mm}body{background-color:white}.page-break-inside-avoid{page-break-inside:avoid}}"})]})}let h=["bg-blue-400","bg-green-400","bg-purple-400","bg-yellow-400","bg-red-400","bg-indigo-400","bg-pink-400","bg-cyan-400","bg-emerald-400","bg-orange-400","bg-teal-400","bg-fuchsia-400"];function x(e){let{employees:t,onEmployeeUpdate:a,onHighlightEmployee:r}=e,[o,n]=(0,s.useState)([{id:"team-1",name:"Engineering",color:"bg-blue-400"},{id:"team-2",name:"Design",color:"bg-green-400"},{id:"team-3",name:"Marketing",color:"bg-purple-400"},{id:"team-4",name:"Sales",color:"bg-yellow-400"}]),[i,c]=(0,s.useState)(""),[m,p]=(0,s.useState)(h[0]),[x,g]=(0,s.useState)(""),[f,b]=(0,s.useState)(!1);(0,s.useEffect)(()=>{g(window.location.href.split("?")[0])},[]),(0,s.useEffect)(()=>{let e=[...new Set(t.map(e=>e.team).filter(e=>void 0!==e&&""!==e))].filter(e=>!o.some(t=>t.name===e));e.length>0&&n([...o,...e.map(e=>({id:"team-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),name:e,color:h[Math.floor(Math.random()*h.length)]}))])},[t,o]),(0,s.useEffect)(()=>{try{let e=localStorage.getItem("officeMapperTeams");e&&n(JSON.parse(e))}catch(e){console.error("Error loading teams from localStorage:",e)}},[]),(0,s.useEffect)(()=>{try{localStorage.setItem("officeMapperTeams",JSON.stringify(o))}catch(e){console.error("Error saving teams to localStorage:",e)}},[o]);let y=(e,t)=>{a(e,{team:t||void 0})},j=e=>{let t=o.find(t=>t.name===e);return t?t.color:"bg-gray-400"},v=e=>{n(o.filter(t=>t.id!==e));let l=o.find(t=>t.id===e);l&&t.forEach(e=>{e.team===l.name&&a(e.id,{team:void 0})})},N=e=>{r&&r(e)};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Team Assignment"}),f&&x&&(0,l.jsx)("div",{className:"fixed inset-0 bg-white z-50",children:(0,l.jsx)(u,{employees:t,baseUrl:x,onClose:()=>b(!1)})}),(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Teams"}),(0,l.jsx)("div",{className:"flex gap-2 flex-wrap mb-3",children:o.map(e=>(0,l.jsxs)("div",{className:"".concat(e.color," px-3 py-1 rounded-full text-sm flex items-center"),children:[e.name,(0,l.jsx)("button",{onClick:()=>v(e.id),className:"ml-2 text-gray-700 hover:text-red-700 focus:outline-none",title:"Remove team",children:"\xd7"})]},e.id))}),(0,l.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,l.jsx)("input",{type:"text",className:"flex-1 px-3 py-2 border rounded-md min-w-[200px]",placeholder:"New team name",value:i,onChange:e=>c(e.target.value)}),(0,l.jsx)("select",{className:"px-3 py-2 border rounded-md",value:m,onChange:e=>p(e.target.value),children:h.map((e,t)=>(0,l.jsxs)("option",{value:e,children:["Color ",t+1]},e))}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md",onClick:()=>{i.trim()&&(n([...o,{id:"team-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),name:i,color:m}]),c(""))},children:"Add Team"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,l.jsx)("h3",{className:"font-medium",children:"Employees"}),t.length>0&&x&&(0,l.jsx)("button",{onClick:()=>b(!0),className:"px-3 py-1 bg-purple-500 text-white rounded-md text-sm hover:bg-purple-600 transition-colors",children:"Export QR Codes"})]}),(0,l.jsxs)("table",{className:"w-full border-collapse",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-100",children:[(0,l.jsx)("th",{className:"text-left p-2 border",children:"Name"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Team"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Actions"})]})}),(0,l.jsxs)("tbody",{children:[t.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>N(e.id),children:[(0,l.jsx)("td",{className:"p-2 border",children:e.name}),(0,l.jsx)("td",{className:"p-2 border",children:e.team?(0,l.jsx)("span",{className:"inline-block px-2 py-1 rounded-full text-xs ".concat(j(e.team)),children:e.team}):"Not assigned"}),(0,l.jsx)("td",{className:"p-2 border",children:(0,l.jsxs)("div",{className:"flex gap-2 items-center",onClick:e=>e.stopPropagation(),children:[(0,l.jsxs)("select",{className:"flex-1 px-2 py-1 border rounded",value:e.team||"",onChange:t=>y(e.id,t.target.value||null),children:[(0,l.jsx)("option",{value:"",children:"No Team"}),o.map(e=>(0,l.jsx)("option",{value:e.name,children:e.name},e.id))]}),x&&(0,l.jsx)(d,{employee:e,baseUrl:x})]})})]},e.id)),0===t.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:3,className:"p-4 text-center text-gray-500",children:"No employees added yet. Add employees on the map first."})})]})]}),r&&(0,l.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:'Click on an employee row to highlight their location on the map. Use the "Show QR" button to generate a QR code that links directly to an employee\'s location. Use "Export QR Codes" to generate a printable page with all employee QR codes.'})]})]})}function g(e){let{employees:t,onHighlightEmployee:a}=e,[r,o]=(0,s.useState)(""),[n,i]=(0,s.useState)(null),[c,d]=(0,s.useState)(t),m=Array.from(new Set(t.filter(e=>e.team).map(e=>e.team)));return(0,s.useEffect)(()=>{let e=[...t];if(r){let t=r.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.team&&e.team.toLowerCase().includes(t))}n&&(e=e.filter(e=>e.team===n)),d(e)},[r,n,t]),(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Search & Filter"}),(0,l.jsxs)("div",{className:"flex gap-4 mb-4",children:[(0,l.jsx)("div",{className:"flex-1",children:(0,l.jsx)("input",{type:"text",className:"w-full px-3 py-2 border rounded-md",placeholder:"Search employees or teams...",value:r,onChange:e=>o(e.target.value)})}),(0,l.jsx)("div",{children:(0,l.jsxs)("select",{className:"w-full px-3 py-2 border rounded-md",value:n||"",onChange:e=>i(e.target.value||null),children:[(0,l.jsx)("option",{value:"",children:"All Teams"}),m.map(e=>(0,l.jsx)("option",{value:e,children:e},e))]})})]}),(0,l.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,l.jsxs)("table",{className:"w-full border-collapse",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-100",children:[(0,l.jsx)("th",{className:"text-left p-2 border",children:"Name"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Team"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Actions"})]})}),(0,l.jsxs)("tbody",{children:[c.map(e=>(0,l.jsxs)("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>a(e.id),children:[(0,l.jsx)("td",{className:"p-2 border",children:e.name}),(0,l.jsx)("td",{className:"p-2 border",children:e.team||"Not assigned"}),(0,l.jsx)("td",{className:"p-2 border",children:(0,l.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded-md text-sm",onClick:t=>{t.stopPropagation(),a(e.id)},children:"Locate"})})]},e.id)),0===c.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:3,className:"p-4 text-center text-gray-500",children:"No employees found matching your search criteria."})})]})]})})]})}function f(e){let{mapImage:t,employees:a,rooms:r,highlightedEmployee:o,onClose:n}=e,i=(0,s.useRef)(null),c=(0,s.useRef)(null),d=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()},t=e=>{i.current&&!i.current.contains(e.target)&&n()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t),document.body.style.overflow="auto"}},[n]),(0,s.useEffect)(()=>{if(o&&c.current&&d.current){let e=d.current,t=c.current,a=e.getBoundingClientRect(),l=t.getBoundingClientRect(),s=l.left+l.width/2-a.left-a.width/2,r=l.top+l.height/2-a.top-a.height/2;e.scrollBy({left:s,top:r,behavior:"smooth"})}},[o]);let m=o?a.find(e=>e.id===o):null;return(0,l.jsx)("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4",children:(0,l.jsxs)("div",{ref:i,className:"bg-white rounded-lg shadow-xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,l.jsxs)("div",{className:"p-4 border-b flex justify-between items-center",children:[(0,l.jsxs)("h2",{className:"text-xl font-semibold",children:["Office Map",m&&(0,l.jsxs)("span",{className:"ml-2 text-blue-600",children:["→ Showing: ",m.name]})]}),(0,l.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsx)("div",{className:"p-4 flex-1 overflow-auto",ref:d,children:(0,l.jsxs)("div",{className:"relative border rounded-lg overflow-hidden",children:[(0,l.jsx)("img",{src:t,alt:"Office Map",className:"w-full h-auto"}),a.map(e=>{let t=o===e.id;return(0,l.jsxs)("div",{ref:t?c:null,className:"absolute transform -translate-x-1/2 -translate-y-1/2 rounded-full flex items-center justify-center text-sm group ".concat(t?"ring-4 ring-red-500 animate-pulse bg-red-200 z-50 w-14 h-14 font-bold":e.team?"".concat(function(e){try{let t=localStorage.getItem("officeMapperTeams");if(t){let a=JSON.parse(t).find(t=>t.name===e);if(a)return a.color}}catch(e){console.error("Error getting team color from localStorage:",e)}let t=["bg-blue-400","bg-green-400","bg-purple-400","bg-yellow-400","bg-red-400","bg-indigo-400","bg-pink-400","bg-cyan-400","bg-emerald-400","bg-orange-400","bg-teal-400","bg-fuchsia-400"];return t[e.split("").reduce((e,t)=>t.charCodeAt(0)+e,0)%t.length]}(e.team)," w-10 h-10"):"bg-gray-400 w-10 h-10"),style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},children:[e.name.substring(0,1).toUpperCase(),(0,l.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 whitespace-nowrap bg-black/80 text-white text-xs px-2 py-1 rounded ".concat(t?"opacity-100":"opacity-0 group-hover:opacity-100"," pointer-events-none transition-opacity z-10"),children:[e.name," ",e.team?"(".concat(e.team,")"):""]})]},e.id)}),r.map(e=>(0,l.jsx)("div",{className:"absolute px-2 py-1 transform -translate-x-1/2 -translate-y-1/2 bg-white/80 border border-gray-300 text-sm",style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},children:e.name},e.id))]})}),(0,l.jsx)("div",{className:"p-4 border-t",children:(0,l.jsxs)("div",{className:"flex gap-4 flex-wrap",children:[(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Total Employees:"})," ",a.length]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Total Rooms:"})," ",r.length]}),(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)("span",{className:"font-medium",children:"Assigned to Teams:"})," ",a.filter(e=>e.team).length]})]})})]})})}function b(e){let{maps:t,currentMapId:a,onSelectMap:r,onAddNewMap:o,onDeleteMap:n,onRenameMap:i}=e,[c,d]=(0,s.useState)(null),[m,p]=(0,s.useState)(""),u=e=>{if(!m.trim())return void d(null);i(e,m),d(null),p("")},h=(e,t)=>{d(e),p(t)},x=(e,t)=>{confirm('Are you sure you want to delete "'.concat(t,'"? This action cannot be undone.'))&&n(e)};return(0,l.jsxs)("div",{className:"w-full",children:[(0,l.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold",children:"Your Maps"}),(0,l.jsx)("button",{className:"px-3 py-1 bg-blue-500 text-white rounded-md text-sm hover:bg-blue-600 transition-colors",onClick:o,children:"Add New Map"})]}),0===t.length?(0,l.jsxs)("div",{className:"text-center p-6 border border-dashed rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-500 mb-3",children:"You don't have any maps yet"}),(0,l.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",onClick:o,children:"Create Your First Map"})]}):(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,l.jsxs)("div",{className:"border rounded-lg overflow-hidden ".concat(a===e.id?"ring-2 ring-blue-500":""),children:[(0,l.jsxs)("div",{className:"h-32 relative cursor-pointer",onClick:()=>r(e.id),children:[e.thumbnail?(0,l.jsx)("img",{src:e.thumbnail,alt:e.name,className:"w-full h-full object-cover"}):(0,l.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center text-gray-400",children:"No Preview"}),a===e.id&&(0,l.jsx)("div",{className:"absolute top-2 left-2 bg-blue-500 text-white px-2 py-1 text-xs rounded",children:"Current"})]}),(0,l.jsx)("div",{className:"p-3 border-t bg-white",children:c===e.id?(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"text",className:"flex-1 px-2 py-1 border rounded text-sm",value:m,onChange:e=>p(e.target.value),autoFocus:!0,onKeyDown:t=>{"Enter"===t.key&&u(e.id),"Escape"===t.key&&d(null)}}),(0,l.jsx)("button",{className:"text-green-500 hover:text-green-700",onClick:()=>u(e.id),children:"✓"}),(0,l.jsx)("button",{className:"text-red-500 hover:text-red-700",onClick:()=>d(null),children:"✕"})]}):(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium text-sm",children:e.name}),(0,l.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.created).toLocaleDateString()})]}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)("button",{className:"p-1 text-gray-500 hover:text-blue-500",onClick:()=>h(e.id,e.name),title:"Rename",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),t.length>1&&(0,l.jsx)("button",{className:"p-1 text-gray-500 hover:text-red-500",onClick:()=>x(e.id,e.name),title:"Delete",disabled:a===e.id,children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]})})]},e.id))})]})}var y=a(5695);function j(){let e=(0,y.useSearchParams)(),[t,a]=(0,s.useState)([]),[o,c]=(0,s.useState)(null),[d,m]=(0,s.useState)(null),[p,u]=(0,s.useState)([]),[h,j]=(0,s.useState)([]),[v,N]=(0,s.useState)("upload"),[w,C]=(0,s.useState)(null),[S,k]=(0,s.useState)(!1),[M,E]=(0,s.useState)(null),[R,T]=(0,s.useState)(!0),[D,I]=(0,s.useState)(!1),[L,A]=(0,s.useState)(!1);(0,s.useEffect)(()=>{if(e){let t=e.get("highlight");t&&(C(t),k(!0));let a=e.get("map");a&&a!==o&&U(a)}},[e]);let O=async()=>{try{if(L){try{let e=localStorage.getItem("officeMapperMaps");if(e){let t=JSON.parse(e);a(t),t.length>0&&!o&&U(t[0].id)}else o||T(!1)}catch(e){console.error("Error loading maps from localStorage:",e),T(!1)}return}let e=await fetch("/api/office-map");if(e.ok){let t=await e.json();if(t.data&&Array.isArray(t.data)){let e=t.data.map(e=>({id:e._id,name:e.name||"Untitled Map",thumbnail:e.thumbnail||"",created:e.createdAt}));a(e),e.length>0&&!o?U(e[0].id):0===e.length&&T(!1)}else console.error("Invalid data format received for maps list"),T(!1)}else console.error("Failed to fetch maps list:",e.statusText),z()}catch(e){console.error("Error loading maps list:",e),z()}},U=async e=>{T(!0);try{if(L){try{let t=localStorage.getItem("officeMapperData_".concat(e));if(t){let a=JSON.parse(t);m(a.mapImage),u(a.employees||[]),j(a.rooms||[]),c(e),a.mapImage?N("employees"):N("upload")}else P("Map not found in local storage","error")}catch(e){console.error("Error loading map from localStorage:",e)}T(!1);return}let t=await fetch("/api/office-map?id=".concat(e));if(t.ok){let a=await t.json();if(a.data){let t=a.data;m(t.mapImage);let l=t.employees.map(e=>({id:e._id||"emp-".concat(Date.now(),"-").concat(Math.random()),name:e.name,position:e.position,team:e.team}));u(l);let s=t.rooms.map(e=>({id:e._id||"room-".concat(Date.now(),"-").concat(Math.random()),name:e.name,position:e.position}));j(s),c(e),t.mapImage?N("employees"):N("upload")}}else 404===t.status?P("Map not found","error"):z()}catch(e){console.error("Error loading specific map:",e),z()}finally{T(!1)}},z=()=>{console.warn("Switching to offline mode"),A(!0);try{let e=localStorage.getItem("officeMapperMaps");if(e){let t=JSON.parse(e);if(a(t),o){let e=localStorage.getItem("officeMapperData_".concat(o));if(e){let t=JSON.parse(e);m(t.mapImage),u(t.employees||[]),j(t.rooms||[])}}else if(t.length>0){let e=t[0].id,a=localStorage.getItem("officeMapperData_".concat(e));if(a){let t=JSON.parse(a);m(t.mapImage),u(t.employees||[]),j(t.rooms||[]),c(e)}}}}catch(e){console.error("Error loading from localStorage:",e)}T(!1)},P=(e,t)=>{E({message:e,type:t}),setTimeout(()=>E(null),5e3)};(0,s.useEffect)(()=>{window.location.hostname.includes("github.io")&&console.log("GitHub Pages deployment detected - checking database availability"),O()},[]);let V=async()=>{if(d&&o)try{I(!0);try{localStorage.setItem("officeMapperData_".concat(o),JSON.stringify({mapImage:d,employees:p,rooms:h}));let e=t.map(e=>e.id===o?{...e,thumbnail:d}:e);a(e),localStorage.setItem("officeMapperMaps",JSON.stringify(e))}catch(e){console.error("Error saving to localStorage:",e)}if(L){E({message:"Data saved locally (offline mode)",type:"success"}),setTimeout(()=>E(null),5e3),I(!1);return}let e=p.map(e=>({name:e.name,position:e.position,team:e.team})),l=h.map(e=>({name:e.name,position:e.position})),s=await fetch("/api/office-map",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:o,mapImage:d,employees:e,rooms:l})});if(s.ok)E({message:"Office map saved successfully!",type:"success"}),setTimeout(()=>E(null),5e3),O();else if(500===s.status)A(!0),E({message:"Database connection failed. Working in offline mode.",type:"error"}),setTimeout(()=>E(null),5e3);else throw Error("Failed to save office map")}catch(e){console.error("Error saving office map:",e),A(!0),E({message:"Failed to save to database. Working in offline mode.",type:"error"}),setTimeout(()=>E(null),5e3)}finally{I(!1)}},F=e=>{console.log("Map upload triggered with file:",e.name);let t=new FileReader;t.onload=e=>{var t;(null==(t=e.target)?void 0:t.result)&&(m(e.target.result),console.log("Map image updated successfully"),d?(E({message:"Map successfully replaced!",type:"success"}),setTimeout(()=>E(null),5e3)):N("employees"),setTimeout(()=>V(),500))},t.readAsDataURL(e)},J=(e,t)=>{u(p.map(a=>a.id===e?{...a,...t}:a)),setTimeout(()=>V(),500)};(0,s.useEffect)(()=>{if(w){let e=setTimeout(()=>{C(null)},5e3);return()=>clearTimeout(e)}},[w]);let B=async()=>{let e=prompt("Enter a name for your new map","New Map");if(null!==e)try{if(T(!0),L){let l="map-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,9)),s={id:l,name:e||"Untitled Map",thumbnail:"",created:new Date().toISOString()},r=[...t,s];a(r),localStorage.setItem("officeMapperMaps",JSON.stringify(r)),localStorage.setItem("officeMapperData_".concat(l),JSON.stringify({mapImage:null,employees:[],rooms:[]})),c(l),m(null),u([]),j([]),N("upload"),P("New map created successfully","success")}else{let t=await fetch("/api/office-map",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e||"Untitled Map",mapImage:"",employees:[],rooms:[]})});if(t.ok){let e=await t.json();e.data&&(await O(),c(e.data._id),m(null),u([]),j([]),N("upload"),P("New map created successfully","success"))}else 500===t.status?(z(),P("Failed to create map in database, working in offline mode","error")):P("Failed to create new map","error")}}catch(e){console.error("Error creating new map:",e),z(),P("Error creating new map, switching to offline mode","error")}finally{T(!1)}},H=async e=>{try{if(T(!0),L){let l=t.filter(t=>t.id!==e);a(l),localStorage.setItem("officeMapperMaps",JSON.stringify(l)),localStorage.removeItem("officeMapperData_".concat(e)),e===o&&(l.length>0?U(l[0].id):(c(null),m(null),u([]),j([]),N("upload"))),P("Map deleted successfully","success")}else{let a=await fetch("/api/office-map?id=".concat(e),{method:"DELETE"});if(a.ok){if(await O(),e===o)if(t.length>1){let a=t.find(t=>t.id!==e);a&&U(a.id)}else c(null),m(null),u([]),j([]),N("upload");P("Map deleted successfully","success")}else 500===a.status?(z(),P("Failed to delete map from database, working in offline mode","error")):P("Failed to delete map","error")}}catch(e){console.error("Error deleting map:",e),z(),P("Error deleting map, switching to offline mode","error")}finally{T(!1)}},_=async(e,l)=>{try{if(L){let s=t.map(t=>t.id===e?{...t,name:l}:t);a(s),localStorage.setItem("officeMapperMaps",JSON.stringify(s)),P("Map renamed successfully","success")}else{let t=await fetch("/api/office-map",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,name:l})});t.ok?(await O(),P("Map renamed successfully","success")):500===t.status?(z(),P("Failed to rename map in database, working in offline mode","error")):P("Failed to rename map","error")}}catch(e){console.error("Error renaming map:",e),z(),P("Error renaming map, switching to offline mode","error")}},W=e=>{e!==o&&(o&&V(),U(e))};return(0,l.jsxs)("div",{className:"min-h-screen p-6",children:[(0,l.jsxs)("header",{className:"mb-8",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"OfficeMapper"}),(0,l.jsxs)("p",{className:"text-gray-600",children:["Upload and manage your office seating plans",L&&" (Offline Mode)"]})]}),o&&d&&(0,l.jsx)("button",{onClick:V,disabled:D,className:"px-4 py-2 rounded-md ".concat(D?"bg-gray-400":"bg-green-500 hover:bg-green-600"," text-white flex items-center gap-2"),children:D?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,l.jsx)("path",{fillRule:"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})}),L?"Save Locally":"Save Map"]})})]}),L&&(0,l.jsx)("div",{className:"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded-md text-sm text-yellow-800",children:"Working in offline mode. Data is saved only to your browser's local storage."}),M&&(0,l.jsx)("div",{className:"mt-4 p-3 rounded-md ".concat("success"===M.type?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:M.message})]}),R?(0,l.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsxs)("svg",{className:"animate-spin h-10 w-10 text-blue-500 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,l.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,l.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,l.jsx)("p",{className:"text-lg text-gray-600",children:"Loading office map data..."})]})}):0===t.length?(0,l.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,l.jsx)(b,{maps:t,currentMapId:o,onSelectMap:W,onAddNewMap:B,onDeleteMap:H,onRenameMap:_})}):o?d?(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsx)(b,{maps:t,currentMapId:o,onSelectMap:W,onAddNewMap:B,onDeleteMap:H,onRenameMap:_})}),(0,l.jsxs)("div",{className:"lg:col-span-2",children:[(0,l.jsx)("div",{className:"border-b mb-4",children:(0,l.jsxs)("nav",{className:"flex flex-wrap space-x-2 space-y-1",children:[(0,l.jsx)("button",{className:"py-2 px-3 rounded-t-md ".concat("employees"===v?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),onClick:()=>N("employees"),children:"Employee Placement"}),(0,l.jsx)("button",{className:"py-2 px-3 rounded-t-md ".concat("rooms"===v?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),onClick:()=>N("rooms"),children:"Room Renaming"}),(0,l.jsx)("button",{className:"py-2 px-3 rounded-t-md ".concat("teams"===v?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),onClick:()=>N("teams"),children:"Team Assignment"}),(0,l.jsx)("button",{className:"py-2 px-3 rounded-t-md ".concat("search"===v?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),onClick:()=>N("search"),children:"Search & Filter"}),(0,l.jsx)("button",{className:"py-2 px-3 rounded-t-md ".concat("upload"===v?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200"),onClick:()=>N("upload"),children:"Change Map"})]})}),"employees"===v&&(0,l.jsx)(n,{mapImage:d,employees:p,onEmployeeAdd:e=>{u([...p,e]),setTimeout(()=>V(),500)},onEmployeeUpdate:J,onEmployeeRemove:e=>{u(p.filter(t=>t.id!==e)),setTimeout(()=>V(),500)},onEmployeesBulkAdd:e=>{u([...p,...e]),N("employees"),E({message:"Successfully imported ".concat(e.length," employees! You can now drag them to their exact positions."),type:"success"}),setTimeout(()=>{E(null)},5e3),setTimeout(()=>V(),500)}}),"rooms"===v&&(0,l.jsx)(i,{mapImage:d,rooms:h,onRoomAdd:e=>{j([...h,e]),setTimeout(()=>V(),500)},onRoomUpdate:(e,t)=>{j(h.map(a=>a.id===e?{...a,...t}:a)),setTimeout(()=>V(),500)},onRoomRemove:e=>{j(h.filter(t=>t.id!==e)),setTimeout(()=>V(),500)}}),"teams"===v&&(0,l.jsx)(x,{employees:p,onEmployeeUpdate:J,onHighlightEmployee:C}),"search"===v&&(0,l.jsx)(g,{employees:p,onHighlightEmployee:C}),"upload"===v&&(0,l.jsx)(r,{onMapUpload:F,existingMapImage:d})]}),(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsxs)("div",{className:"border rounded-lg p-4 sticky top-6",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Preview"}),(0,l.jsxs)("div",{className:"relative border rounded-lg overflow-hidden cursor-pointer group",onClick:()=>k(!0),children:[(0,l.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:(0,l.jsx)("div",{className:"bg-white/80 rounded-full p-2",children:(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})}),(0,l.jsx)("img",{src:d,alt:"Office Map",className:"w-full h-auto"}),p.map(e=>(0,l.jsxs)("div",{className:"absolute w-6 h-6 transform -translate-x-1/2 -translate-y-1/2 rounded-full flex items-center justify-center text-xs group ".concat(w===e.id?"ring-4 ring-red-500 animate-pulse bg-red-200 z-50 w-8 h-8 font-bold":e.team?function(e){try{let t=localStorage.getItem("officeMapperTeams");if(t){let a=JSON.parse(t).find(t=>t.name===e);if(a)return a.color}}catch(e){console.error("Error getting team color from localStorage:",e)}let t=["bg-blue-400","bg-green-400","bg-purple-400","bg-yellow-400","bg-red-400","bg-indigo-400","bg-pink-400","bg-cyan-400","bg-emerald-400","bg-orange-400","bg-teal-400","bg-fuchsia-400"];return t[e.split("").reduce((e,t)=>t.charCodeAt(0)+e,0)%t.length]}(e.team):"bg-gray-400"),style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},children:[e.name.substring(0,1).toUpperCase(),(0,l.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-1 whitespace-nowrap bg-black/80 text-white text-xs px-2 py-1 rounded opacity-0 group-hover:opacity-100 pointer-events-none transition-opacity",children:[e.name," ",e.team?"(".concat(e.team,")"):""]})]},e.id)),h.map(e=>(0,l.jsx)("div",{className:"absolute px-1 py-0.5 transform -translate-x-1/2 -translate-y-1/2 bg-white/80 border border-gray-300 text-xs",style:{left:"".concat(e.position.x,"%"),top:"".concat(e.position.y,"%")},children:e.name},e.id))]}),(0,l.jsxs)("div",{className:"mt-4",children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Statistics"}),(0,l.jsxs)("ul",{className:"text-sm space-y-1",children:[(0,l.jsxs)("li",{children:["Total Employees: ",p.length]}),(0,l.jsxs)("li",{children:["Total Rooms: ",h.length]}),(0,l.jsxs)("li",{children:["Assigned to Teams: ",p.filter(e=>e.team).length]})]})]})]})})]}):(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsx)(b,{maps:t,currentMapId:o,onSelectMap:W,onAddNewMap:B,onDeleteMap:H,onRenameMap:_})}),(0,l.jsx)("div",{className:"lg:col-span-3",children:(0,l.jsx)(r,{onMapUpload:F,existingMapImage:d})})]}):(0,l.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,l.jsx)(b,{maps:t,currentMapId:o,onSelectMap:W,onAddNewMap:B,onDeleteMap:H,onRenameMap:_})}),S&&d&&(0,l.jsx)(f,{mapImage:d,employees:p,rooms:h,highlightedEmployee:w,onClose:()=>k(!1)})]})}}}]);